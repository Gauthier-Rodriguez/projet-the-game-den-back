BEGIN; 

DROP TABLE IF EXISTS "User", "Game", "Genre", "Platform", "UserHasGame", "UserHasGenre", "UserHasPlatform" CASCADE;

CREATE TABLE "User" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "Pseudo" VARCHAR(255) NOT NULL UNIQUE,
    "LastName" TEXT NOT NULL,
    "FirstName" TEXT NOT NULL,
    "Email" VARCHAR(255) NOT NULL,
    "Password" VARCHAR(255) NOT NULL,
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ
);

CREATE TABLE "Game" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "GameID" INTEGER NOT NULL UNIQUE,
    "Name" VARCHAR(255) NOT NULL UNIQUE,
    "Image" VARCHAR(255) NOT NULL UNIQUE,
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ
);

CREATE TABLE "Platform" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "Name"  VARCHAR(255) NOT NULL UNIQUE,
    "PlatformID" INTEGER NOT NULL UNIQUE,
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ
);

CREATE TABLE "Genre" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "Name"  TEXT NOT NULL UNIQUE,
  "GenreID" INTEGER NOT NULL UNIQUE,
  "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "Updated_at" TIMESTAMPTZ
);

CREATE TABLE "UserHasGame" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "UserID" INT REFERENCES "User"("id"),
    "GameID" INT REFERENCES "Game"("id"),
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ
);

CREATE TABLE "UserHasGenre" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "UserID" INT REFERENCES "User"("id"),
    "GenreID" INT REFERENCES "Genre"("id"),
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ

);

CREATE TABLE "UserHasPlatform" (
    "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "UserID" INT REFERENCES "User"("id"),
    "PlatformID" INT REFERENCES "Platform"("id"),
    "Created_at" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Updated_at" TIMESTAMPTZ
);

COMMIT;